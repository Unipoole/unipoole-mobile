"use strict";synthMobile.controller("ScheduleCtrl",["$scope","$rootScope","$filter","$timeout","ScheduleService","SynthErrorHandler",function(e,n,t,a,i,r){function o(e,n){var t=[];for(var a in c){var i=c[a];null===i.end&&(i.end=i.start+1),e.isBefore(i.start)&&n.isAfter(i.end)&&t.push(i)}return t}n.activePage="schedule",n.breadcrumbs=[{name:"Schedule"}],e.filterOption="today";var c=[];e.startCalendar=new Date,e.endCalendar=new Date,e.loadingSchedule=!0,e.orderDateFunc=function(e){return moment(e.start).valueOf()},e.open=function(n,t){n.preventDefault(),n.stopPropagation(),"start"===t?(e.startCalendarOpen=!0,e.endCalendarOpen=!1):(e.endCalendarOpen=!0,e.startCalendarOpen=!1)},e.changedFilterOption=function(){e.loadingSchedule=!0,a(function(){var n=e.filterOption,t=moment(),a=moment();if("all"===n)return e.schedule=c,void(e.loadingSchedule=!1);if("startEnd"===n){if(void 0===e.startCalendar||""===e.startCalendar)return e.schedule=[],void(e.loadingSchedule=!1);t=moment(e.startCalendar),a=void 0===e.endCalendar||""===e.endCalendar?moment(t).add("years",50):moment(e.endCalendar)}else if("today"===n)t=moment().startOf("day"),a=moment().endOf("day");else if("week"===n)t=moment().startOf("week"),a=moment().endOf("week");else if("month"===n)t=moment().startOf("month"),a=moment().endOf("month");else if("year"===n)t=moment().startOf("year"),a=moment().endOf("year");else if("specific"===n){var i=[];if(void 0!==e.specificYear&&""!==e.specificYear){if(e.specificMonthDisabled=!1,t=moment(e.specificYear,"YYYY"),void 0!==e.specificMonth&&""!==e.specificMonth){e.specificDayDisabled=!1,t=moment(e.specificYear+"-"+e.specificMonth,"YYYY-M");var r=moment(e.specificYear+"-"+e.specificMonth).daysInMonth();void 0!==e.specificDay&&""!==e.specificDay&&(e.specificDay>r&&(e.specificDay=1),t=moment(e.specificYear+"-"+e.specificMonth+"-"+e.specificDay,"YYYY-M-D"));for(var d=1;r>=d;d++)i.push(d);e.days=i}a=moment(t).add("years",50)}else e.specificMonthDisabled=!0,e.specificDayDisabled=!0;e.days=i}e.loadingSchedule=!1,e.schedule=o(t,a)},500)},i.getAll().then(function(n){c=t("object2Array")(n),e.changedFilterOption()},r)}]);